{
  "_id": "{{@ system @}}",
  "oauth2": {
    "access_token": "$SECRET(oauth_access_token)",
    "client_id": "$SECRET(oauth_client_id)",
    "client_secret": "$SECRET(oauth_client_secret)",
    "refresh_token": "$SECRET(oauth_refresh_token)",
    "token_url": "{{@ token_url @}}"
  },
  "operations": {
    "alternate_list": {
      "headers": {
        "Accept": "application/json",
        "X-Sesam-Page": "{% if (previous_request_headers is defined and previous_request_headers['X-Sesam-Page'] is defined) %}{{ previous_request_headers['X-Sesam-Page']|int + 1 }}{% else %}1{% endif %}"
      },
      "method": "GET",
      "next_page_link": "https://sod.superoffice.com/{{@ account_id @}}/api/v1/{{ properties.datatype|capitalize }}",
      "next_page_termination_strategy": [
        "same-next-page-request",
        "empty-result"
      ],
      "params": {
        "$orderby": "{{ properties.ordering }}",
        "$skip": "{% if (previous_request_headers['X-Sesam-Page'] is defined) %}{{ properties.top|int*(headers['X-Sesam-Page']|int-1) }}{% else %}0{% endif %}sesam:markjson",
        "$top": "{{ properties.top }}"
      },
      "url": "{{ properties.datatype }}"
    },
    "contact-delete": {
      "method": "DELETE",
      "url": "Contact/{{ entity.ContactId }}"
    },
    "contact-insert": {
      "method": "POST",
      "url": "Contact"
    },
    "contact-list": {
      "headers": {
        "Accept": "application/json"
      },
      "id_expression": "{{ PrimaryKey }}",
      "method": "GET",
      "next_page_link": "https://sod.superoffice.com/{{@ account_id @}}/api/v1/Contact",
      "next_page_termination_strategy": [
        "same-next-page-request",
        "empty-result"
      ],
      "params": {
        "$filter": "{% if since is defined and since is not none %}(updatedDate ge '{{ since }}'){% else %}(updatedDate ge '1970-01-01'){% endif %}",
        "$orderby": "name asc",
        "$skip": "{{ 20|int*page }}",
        "$top": "20"
      },
      "payload_property": "value",
      "updated_expression": "{{ updatedDate }}",
      "url": "Contact"
    },
    "contact-lookup": {
      "headers": {
        "Accept": "application/json"
      },
      "method": "GET",
      "url": "Contact/{{ entity.ContactId }}"
    },
    "contact-lookup-from-list": {
      "headers": {
        "Accept": "application/json"
      },
      "method": "GET",
      "url": "Contact/{{ entity.contactId }}"
    },
    "contact-update": {
      "method": "PUT",
      "url": "Contact/{{ entity.ContactId }}"
    },
    "list": {
      "headers": {
        "Accept": "application/json",
        "X-Sesam-Page": "{% if (previous_request_headers is defined and previous_request_headers['X-Sesam-Page'] is defined) %}{{ previous_request_headers['X-Sesam-Page']|int + 1 }}{% else %}1{% endif %}"
      },
      "id_expression": "{{ PrimaryKey }}",
      "method": "GET",
      "next_page_link": "https://sod.superoffice.com/{{@ account_id @}}/api/v1/{{ properties.datatype|capitalize }}",
      "next_page_termination_strategy": [
        "same-next-page-request",
        "empty-result"
      ],
      "params": {
        "$filter": "{% if since is defined and since is not none %}({{ properties.since_param }} ge '{{ since }}'){% else %}({{ properties.since_param }} ge '1970-01-01'){% endif %}",
        "$orderby": "{{ properties.ordering }}",
        "$skip": "{% if (previous_request_headers['X-Sesam-Page'] is defined) %}{{ properties.top|int*(headers['X-Sesam-Page']|int-1) }}{% else %}0{% endif %}sesam:markjson",
        "$top": "{{ properties.top }}"
      },
      "payload_property": "value",
      "url": "{{ properties.datatype|capitalize }}"
    },
    "list_list": {
      "headers": {
        "Accept": "application/json",
        "X-Sesam-Page": "{% if (previous_request_headers is defined and previous_request_headers['X-Sesam-Page'] is defined) %}{{ previous_request_headers['X-Sesam-Page']|int + 1 }}{% else %}1{% endif %}"
      },
      "method": "GET",
      "next_page_link": "https://sod.superoffice.com/{{@ account_id @}}/api/v1/{{ properties.datatype|capitalize }}",
      "next_page_termination_strategy": [
        "same-next-page-request",
        "empty-result"
      ],
      "params": {
        "$orderby": "{{ properties.ordering }}",
        "$skip": "{% if page is gt 0) %}{{ properties.top|int*(headers['X-Sesam-Page']|int-1) }}{% else %}0{% endif %}sesam:markjson",
        "$top": "{{ properties.top }}"
      },
      "url": "List/{{ properties.datatype }}/Items"
    },
    "lookup": {
      "headers": {
        "Accept": "application/json"
      },
      "method": "GET",
      "payload_property": "value",
      "url": "{{ properties.datatype|capitalize }}/{{ entity._id }}"
    },
    "quote-lookup": {
      "headers": {
        "Accept": "application/json"
      },
      "method": "POST",
      "payload": {
        "QuoteId": "{{ entity['quote/quoteId'] }}"
      },
      "url": "Agents/Quote/GetQuoteEntity"
    },
    "quotealternative-lookup": {
      "headers": {
        "Accept": "application/json"
      },
      "method": "POST",
      "payload": {
        "QuoteVersionId": "{{ entity['QuoteVersionId'] }}"
      },
      "url": "Agents/Quote/GetQuoteAlternatives"
    },
    "quoteline-lookup": {
      "headers": {
        "Accept": "application/json"
      },
      "method": "POST",
      "payload": {
        "QuoteAlternativeId": "{{ entity['QuoteAlternativeId'] }}"
      },
      "url": "Agents/Quote/GetQuoteLines"
    },
    "quoteversion-lookup": {
      "headers": {
        "Accept": "application/json"
      },
      "method": "POST",
      "payload": {
        "QuoteId": "{{ entity['QuoteId'] }}"
      },
      "url": "Agents/Quote/GetQuoteVersions"
    },
    "salequote-list": {
      "headers": {
        "Accept": "application/json",
        "X-Sesam-Page": "{% if (previous_request_headers is defined and previous_request_headers['X-Sesam-Page'] is defined) %}{{ previous_request_headers['X-Sesam-Page']|int + 1 }}{% else %}1{% endif %}"
      },
      "id_expression": "{{ PrimaryKey }}",
      "method": "GET",
      "next_page_link": "https://sod.superoffice.com/{{@ account_id @}}/api/v1/archive/Sale?$select=saleId,quote/quoteId,quote/connectionId,updatedDate",
      "next_page_termination_strategy": [
        "same-next-page-request",
        "empty-result"
      ],
      "params": {
        "$filter": "{% if since is defined and since is not none %}(updatedDate ge '{{ since }}'){% else %}(updatedDate ge '1970-01-01'){% endif %}",
        "$orderby": "name asc",
        "$skip": "{% if (previous_request_headers['X-Sesam-Page'] is defined) %}{{ 1000|int*(headers['X-Sesam-Page']|int-1) }}{% else %}0{% endif %}sesam:markjson",
        "$top": "1000"
      },
      "payload_property": "value",
      "url": "archive/Sale?$select=quote/quoteId,updatedDate"
    }
  },
  "type": "system:rest",
  "url_pattern": "https://sod.superoffice.com/{{@ account_id @}}/api/v1/%s",
  "verify_ssl": true
}